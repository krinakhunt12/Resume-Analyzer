<div class="app-container">
  <header class="app-header">
    <h1>Resume Analyzer</h1>
    <p>Enterprise ATS matching & intelligence dashboard</p>
  </header>

  <main>
    <!-- Upload Flow -->
    <div class="upload-flow" *ngIf="!results() && !isLoading()">
      <div class="card">
        <h2 class="section-title">Resume Document</h2>
        <div class="drop-zone" [class.active]="resumeFile()">
          <div class="icon">ðŸ“„</div>
          <h3 *ngIf="!resumeFile()">Upload or drop resume</h3>
          <h3 *ngIf="resumeFile()" style="color: var(--primary)">{{ resumeFileName() }}</h3>
          <p>Supports .pdf, .docx up to 16MB</p>
          <input type="file" (change)="onFileChange($event, 'resume')" accept=".pdf,.docx,.doc">
        </div>
      </div>

      <div class="card">
        <h2 class="section-title">Contextual Job Description</h2>
        <div class="jd-box">
          <textarea class="jd-textarea" name="jd_text" [(ngModel)]="jdText"
            placeholder="Paste target job description to calculate match scores and identify keyword gaps..."></textarea>
        </div>
      </div>

      <div class="error-box" *ngIf="errorMsg()">
        {{ errorMsg() }}
      </div>

      <button class="btn-primary" (click)="onSubmit($event)" [disabled]="!resumeFile() || isLoading()">
        {{ isLoading() ? 'Running Analysis...' : 'Analyze Workflow' }}
      </button>
    </div>

    <!-- Loading State -->
    <div class="loading-state" *ngIf="isLoading()">
      <div class="spinner"></div>
      <p style="font-weight: 600; font-size: 1.25rem;">Processing Intelligence</p>
      <p style="color: var(--text-secondary); font-size: 0.95rem; margin-top: 0.5rem;">Cross-referencing experience with
        industry benchmarks...</p>
    </div>

    <!-- Results Section -->
    <div class="results-container" *ngIf="results()">

      <!-- Score Overview -->
      <div class="card score-card">
        <div>
          <div class="rating-badge" [ngClass]="getRatingClass(results().rating)">
            {{ results().rating }}
          </div>
          <h2>ATS Integrity Score</h2>
          <p style="color: var(--text-secondary); font-size: 0.9rem;">Structural and keyword compatibility analysis.</p>
        </div>
        <div class="score-visual">
          <span class="score-number">{{ results().overall_score | number:'1.0-0' }}</span>
        </div>
      </div>

      <!-- Recruiter Insights -->
      <div class="card" *ngIf="recruiterInsights()">
        <h2 class="section-title">Candidate Profile</h2>
        <div class="info-grid">
          <div class="info-item">
            <label>Full Name</label>
            <span>{{ recruiterInsights().candidate_details.name }}</span>
          </div>
          <div class="info-item">
            <label>Professional Tenure</label>
            <span>{{ recruiterInsights().candidate_details.total_years_experience }} Years</span>
          </div>
          <div class="info-item">
            <label>Email Address</label>
            <span>{{ recruiterInsights().candidate_details.email }}</span>
          </div>
          <div class="info-item">
            <label>Primary Phone</label>
            <span>{{ recruiterInsights().candidate_details.phone }}</span>
          </div>
        </div>
      </div>

      <!-- Skills Taxonomy -->
      <div class="card" *ngIf="recruiterInsights()">
        <h2 class="section-title">Technical Taxonomy</h2>

        <div style="margin-bottom: 2rem;">
          <label class="info-item"
            style="margin-bottom: 0.75rem; display: block; font-size: 0.75rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase;">Core
            Technologies</label>
          <div class="pill-group">
            <span class="pill pill-primary" *ngFor="let skill of recruiterInsights().key_sections.skills.technical">{{
              skill }}</span>
          </div>
        </div>

        <div style="margin-bottom: 2rem;">
          <label class="info-item"
            style="margin-bottom: 0.75rem; display: block; font-size: 0.75rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase;">Infrastructure
            & Tooling</label>
          <div class="pill-group">
            <span class="pill pill-primary" *ngFor="let skill of recruiterInsights().key_sections.skills.tools">{{ skill
              }}</span>
          </div>
        </div>

        <div>
          <label class="info-item"
            style="margin-bottom: 0.75rem; display: block; font-size: 0.75rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase;">Professional
            Competencies</label>
          <div class="pill-group">
            <span class="pill" *ngFor="let skill of recruiterInsights().key_sections.skills.soft_skills">{{ skill
              }}</span>
          </div>
        </div>
      </div>

      <!-- Quality & Improvements -->
      <div class="card" *ngIf="recruiterInsights()">
        <h2 class="section-title">Evaluation Metrics</h2>

        <div style="margin-bottom: 2.5rem;">
          <label class="info-item"
            style="color: var(--success); margin-bottom: 1rem; display: block; font-size: 0.75rem; font-weight: 700; text-transform: uppercase;">Identified
            Strengths</label>
          <div class="status-list">
            <div class="status-item success" *ngFor="let s of recruiterInsights().resume_quality.strengths">
              <span>âœ“ {{ s }}</span>
            </div>
            <div *ngIf="!recruiterInsights().resume_quality.strengths.length"
              style="color: var(--text-secondary); font-size: 0.95rem;">No major strengths identified.</div>
          </div>
        </div>

        <div>
          <label class="info-item"
            style="color: var(--warning); margin-bottom: 1rem; display: block; font-size: 0.75rem; font-weight: 700; text-transform: uppercase;">Strategic
            Improvements</label>
          <div class="status-list">
            <div class="status-item warning"
              *ngFor="let s of recruiterInsights().improvement_suggestions.content_improvements">
              <span>â€¢ {{ s }}</span>
            </div>
            <div class="status-item danger"
              *ngFor="let s of recruiterInsights().resume_quality.missing_or_unclear_information">
              <span>! Missing Integrity: {{ s | titlecase }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Growth Roadmap -->
      <div class="card" *ngIf="results().career_roadmap">
        <h2 class="section-title">Professional Trajectory</h2>
        <div style="background: var(--primary-light); padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem;">
          <label
            style="font-size: 0.75rem; font-weight: 700; color: var(--primary); text-transform: uppercase; margin-bottom: 0.5rem; display: block;">Target
            Next Horizon</label>
          <p style="font-size: 1.25rem; font-weight: 700; color: var(--primary);">{{
            results().career_roadmap.target_next_level }}</p>
        </div>

        <div class="status-list">
          <div *ngFor="let step of results().career_roadmap.steps; let i = index"
            style="display: flex; gap: 1.5rem; align-items: flex-start; padding: 1.5rem; border-bottom: 1px solid var(--border-subtle);">
            <div style="font-weight: 800; color: var(--primary); font-size: 1rem;">0{{ i + 1 }}</div>
            <div style="font-size: 1rem; color: var(--text-primary); font-weight: 500;">{{ step }}</div>
          </div>
        </div>
      </div>

      <!-- Action Footer -->
      <div class="footer-actions">
        <button class="btn-secondary" (click)="results.set(null)">New Analysis</button>
        <button class="btn-primary" style="width: auto;" (click)="scrollToTop()">Return to Top</button>
      </div>
    </div>
  </main>
</div>